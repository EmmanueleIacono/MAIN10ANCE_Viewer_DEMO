<!DOCTYPE html>
<html>
<head>
  <title>MAIN10ANCE Viewer</title>
  <meta charset="utf-8" />
  <link rel="icon" type="image/png" href="./img/favicon.ico" />
  <!-- Common packages: jQuery, Bootstrap, jsTree -->
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/jstree/3.3.7/jstree.min.js"></script>
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/jstree/3.3.7/themes/default/style.min.css" />
  <!-- LEAFLET -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A==" crossorigin=""/>
  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js" integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA==" crossorigin=""></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.7.4/proj4.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/proj4leaflet/1.0.2/proj4leaflet.min.js"></script>
  <!-- jsPDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.2/html2canvas.min.js"></script>
  <!-- FullCalendar -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fullcalendar@5.9.0/main.min.css">
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.9.0/main.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.9.0/locales-all.min.js"></script>
  <!-- Autodesk Forge Viewer files -->
  <link rel="stylesheet" href="https://developer.api.autodesk.com/modelderivative/v2/viewers/7.*/style.min.css" type="text/css">
  <script src="https://developer.api.autodesk.com/modelderivative/v2/viewers/7.*/viewer3D.min.js"></script>
  <!-- this project files -->
  <link href="css/main.css" rel="stylesheet" />
  <script src="js/ForgeTree.js"></script>
  <script src="js/ForgeViewer.js"></script>
  <!-- PER QUESTI SOTTO SERVE DEFER PER CARICARLI DOPO L'HTML -->
  <script src="js/BIM-DB.js" defer></script>
  <script src="js/BIM-modulo.js" defer></script>
  <script src="js/MappaGIS.js" defer></script>
  <script src="js/ConsultazioneDB.js" defer></script>
  <script src="js/calendario.js" defer></script>
  <script src="js/schede-viewer.js" defer></script>
</head>
<body>
  <!-- CARICAMENTO -->
  <!-- <div id="loading">
    <img id="loading-image" src="./img/ajax-loader-2.gif" alt="Loading..." />
  </div> -->
  <!-- Fixed navbar by Bootstrap: https://getbootstrap.com/examples/navbar-fixed-top/ -->
  <nav class="navbar navbar-default navbar-fixed-top">
    <div class="container-fluid">
      <ul class="nav navbar-nav left tabs">
        <li>
          <a href="https://main10ance.eu/" target="_blank" id="logoSito">
            <img alt="Main10ance" src="./img/AsseII_MAIN10ANCE.png" height="50">
          </a>
        </li>
        <li>
          <div id="dropdown-container">
            <!-- <button type="button" class="navBtn" id="scegliModello" data-toggle="modal" data-target="#scegliModelloModal">SELEZIONA CAPPELLA</button> -->
            <!-- <button type="button" class="navBtn dropdown-toggle" id="scegliModello" data-toggle="dropdown">
              SELEZIONA CAPPELLA <span class="glyphicon glyphicon-triangle-bottom"></span>
            </button> -->
            <div class="panel panel-default dropdown-menu">
              <!-- <div class="panel-heading" id="pannello-modal-header" data-toggle="tooltip">
                Buckets &amp; Objects
                <span id="refreshBuckets" class="glyphicon glyphicon-refresh" style="cursor: pointer"></span>
              </div> -->
              <!-- <div id="appBuckets">
                tree here
              </div> -->
            </div>
          </div>
        </li>
        <!-- <li data-tab-target="#forgeViewer" class="tab" id="apriTabBIM">BIM VIEWER</li>
        <li data-tab-target="#tabMappa" class="tab" id="apriTabGIS">GIS VIEWER</li>
        <li data-tab-target="#tabDatabase" class="tab" id="apriTabDatabase">DATABASE</li>
        <li data-tab-target="#tabDashboard" class="tab" id="apriTabDashboard">DASHBOARD</li> -->
        <li data-tab-target="#tab2" class="tab" id="apriTabGIS">GIS VIEWER</li>
        <li data-tab-target="#tab1" class="tab" id="apriTabBIM">BIM VIEWER</li>
        <li data-tab-target="#tab4" class="tab" id="apriTabSchede">PLANNER</li>
        <li data-tab-target="#tab3" class="tab" id="apriTabDatabase" style="display: none;">DASHBOARD</li>
        <!-- <li data-tab-target="#tab4" class="tab" id="apriTabDashboard">DASHBOARD</li> -->
      </ul>
      <div class="pull-right">
        <ul class="nav navbar-nav">
          <li class="tab">LOGIN</li>
        </ul>
      </div>
    </div>
  </nav>
  <!-- End of navbar -->
  <div class="container-fluid fill">
    <div class="row fill tab-content">
      <div class="fill" id="tab1" data-tab-content>
        <div class="col-sm-7 fill">
          <div id="forgeViewer"></div>
        </div>
        <!-- SEZIONE DB -->
        <div class="col-sm-5 fill" id="pannello-db">
          <div class="panel panel-default fill" id="pannello-db-child">
            <div class="panel-heading" id="pannello-db-header" data-toggle="tooltip">
              <b>EXPLORER</b>
            </div>
            <div class="panel-body">
              <details>
                <summary class="sommario-main10ance"><b>SELEZIONE MODELLI</b></summary>
                <div id="appBuckets">
                  tree here
                </div>
              </details>
              <div class="pannelloDB">
                <!-- BOTTONE DI REFRESH -->
                <button id="refreshParams" class="glyphicon glyphicon-home dbBtn" title="Home" style="cursor: pointer" height="30"></button>

                <!-- BOTTONE DI RICERCA -->
                <button id="cercaID" class="glyphicon glyphicon-search dbBtn" title="Trova" style="cursor: pointer" height="30"></button>
    
                <!-- BOTTONE DI QUERY -->
                <button id="queryDB" class="glyphicon glyphicon-list-alt dbBtn" title="Interroga e modifica" style="cursor: pointer" height="30"></button>

                <!-- BOTTONE DI AGGIUNTA -->
                <button id="aggiungiDB" class="glyphicon glyphicon-plus dbBtn" title="Aggiungi" style="cursor: pointer" height="30"></button>
    
                <!-- BOTTONE DI MODIFICA -->
                <button id="modificaDB" class="glyphicon glyphicon-floppy-disk dbBtn" title="Salva" style="cursor: pointer" height="30"></button>
    
                <!-- BOTTONE DI ANNULLA -->
                <button id="annullaDB" class="glyphicon glyphicon-erase dbBtn" title="Annulla" style="cursor: pointer" height="30"></button>

                <br>
                <div id="contenitore-campo-ricerca"></div>
    
                <!-- FORM -->
                <form id="formDB" spellcheck="false"></form>
              </div>
            <div id="contenitore-controllo-intervento">
              <button class="scheda-controllo" id="apriTabControllo">SCHEDA CONTROLLO</button>
              <button class="scheda-intervento" id="apriTabIntervento">SCHEDA INTERVENTO</button>
              <button id="salvaSchedaControllo" class="glyphicon glyphicon-floppy-disk dbBtn" title="Salva" style="cursor: pointer" height="30"></button>
              <button id="salvaSchedaIntervento" class="glyphicon glyphicon-floppy-disk dbBtn" title="Salva" style="cursor: pointer" height="30"></button>
              <button id="chiudiSchede" class="glyphicon glyphicon-remove dbBtn" title="Chiudi schede" style="cursor: pointer" height="30"></button>
              <div id="scheda-controllo" class="scheda-con-int">SCHEDA CONTROLLO</div>
              <div id="scheda-intervento" class="scheda-con-int">SCHEDA INTERVENTO</div>
            </div>
            </div>
          </div>
        </div>
        <!-- FINE SEZIONE DB -->
      </div>
      <div class="fill" id="tab2" data-tab-content>
        <div class="panel panel-default col-sm-9 fill" id="tabMappa">
          <!-- <div class="panel-heading" id="pannello-modal-header" data-toggle="tooltip"></div> -->
          <!-- GIS -->
          <div id="appGIS">
            <div id="mappa"></div>
            <!-- <div id="legendaLayer">QUI LAYERS</div> -->
          </div>
        </div>
        <!-- PANNELLO LATERALE -->
        <div class="col-sm-3 fill" id="pannello-lat-gis">
          <div class="panel panel-default fill" id="pannello-lat-gis-child">
            <div class="panel-heading" id="pannello-lat-gis-header" data-toggle="tooltip">
              <b>EXPLORER</b>
            </div>
            <div class="panel-body pannelloLatGIS">
              <details>
                <summary class="sommario-main10ance"><b>NAVIGAZIONE</b></summary>
                <div id="contenitore-selettori">
                  <span id="refreshGIS" class="glyphicon glyphicon-refresh" style="cursor: pointer"></span>
                  <br>
                  <div class="menu-sm" id="contenitore-selettori-2"></div>
                </div>
              </details>
              <br>
              <div id="contenitore-livelli-div">
                <details id="contenitore-livelli-details">
                  <summary id="contenitore-livelli-summary" class="sommario-main10ance"><b>LIVELLI GIS</b></summary>
                  <div id="contenitore-livelli-loading">
                    <img id="loading-image" src="./img/ajax-loader-3.gif" alt="Loading..." />
                  </div>
                  <div id="contenitore-livelli-div-interno" style="display: none;"></div>
                </details>
              <!-- <button type="button" id="spegniGIS">MOSTRA/NASCONDI GIS</button> -->
              </div>
              <!-- FORM -->
              <form id="formDBGIS" spellcheck="false"></form>
            </div>
          </div>
        </div>
        <!-- FINE PANNELLO LATERALE -->
      </div>
      <div class="fill" id="tab4" data-tab-content>
        <div class="panel panel-default col-sm-7 fill" id="tabSchede">
          <h4 id="tabella-titolo">
            <span id="refreshSchede" class="glyphicon glyphicon-refresh" style="cursor: pointer"></span>
            <b>SCHEDE</b>
          </h4>
          <div id="contenitore-schede">
            QUI SCHEDE
          </div>
        </div>
        <div class="col-sm-5 fill" id="pannello-lat-schede">
          <div class="panel panel-default fill" id="pannello-lat-schede-inner">
            <div class="panel-heading" id="pannello-lat-schede-header" data-toggle="tooltip">
              <b>EXPLORER</b>
            </div>
            <div class="panel-body pannelloLatSchede" id="pannello-lat-schede-body">
              <div id="calendar"></div>
              <details id="details-filtri-schede" open>
                <summary class="sommario-main10ance"><b>FILTRI</b></summary>
                <input type="checkbox" name="check-generale" id="check-generale">
                <label for="check-generale">ATTIVA FILTRI</label>
                <br>
                <button id="vedi-schede-tutto" class="vedi-schede-disatt" disabled>SELEZIONA TUTTO</button>
                <button id="vedi-schede-nulla" class="vedi-schede-disatt" disabled>DESELEZIONA TUTTO</button>
                <br>
                <input type="checkbox" name="check-tipo-scheda" id="check-tipo-scheda" class="filtro-schede" disabled>
                <label for="check-tipo-scheda">Scheda</label>
                <select name="select-tipo-scheda" id="select-tipo-scheda">
                  <option value="scheda controllo">Scheda controllo</option>
                  <option value="scheda manutenzione regolare">Scheda manutenzione regolare</option>
                  <option value="scheda manutenzione correttiva">Scheda manutenzione correttiva</option>
                  <option value="scheda restauro">Scheda restauro</option>
                </select>
                <br>
                <input type="checkbox" name="check-sacro-monte" id="check-sacro-monte" class="filtro-schede" disabled>
                <label for="check-sacro-monte">Sacro Monte</label>
                <select name="select-sacro-monte" id="select-sacro-monte"></select>
                <br>
                <input type="checkbox" name="check-cappella" id="check-cappella" class="filtro-schede" disabled>
                <label for="check-cappella">Cappella</label>
                <select name="select-cappella" id="select-cappella"></select>
                <br>
                <input type="checkbox" name="check-elemento" id="check-elemento" class="filtro-schede" disabled>
                <label for="check-elemento">Elemento</label>
                <select name="select-elemento" id="select-elemento"></select>
                <br>
                <input type="checkbox" name="check-stato-conservazione" id="check-stato-conservazione" class="filtro-schede" disabled>
                <label for="check-stato-conservazione">Stato di conservazione</label>
                <select name="select-stato-conservazione" id="select-stato-conservazione"></select>
                <br>
                <input type="checkbox" name="check-fenomeno" id="check-fenomeno" class="filtro-schede" disabled>
                <label for="check-fenomeno">Fenomeno</label>
                <select name="select-fenomeno" id="select-fenomeno"></select>
                <br>
                <input type="checkbox" name="check-data" id="check-data" class="filtro-schede" disabled>
                <label for="check-data">Data</label>
                <label for="input-data-da" style="font-weight: normal;">Da</label>
                <input type="date" name="input-data-da" id="input-data-da">
                <label for="input-data-a" style="font-weight: normal;">A</label>
                <input type="date" name="input-data-a" id="input-data-a">
                <br>
              </details>
            </div>
          </div>
        </div>
      </div>
      <div class="fill" id="tab3" data-tab-content>
        <div class="panel panel-default col-sm-7 fill" id="tabDatabase">
          <div id="filtroDB">
            <div id="colDBLOD34" class="colonnaDB">
              <form>
                <label for="radioSM">Sacro Monte</label>
                <select name="selectSM" id="selectSM"></select>
                <br>
                <label for="selectCappella">Cappella</label>
                <select name="selectCappella" id="selectCappella"></select>
                <br>
                <input type="radio" name="radioLOD" id="radioLOD3">
                <label for="radioLOD3">Opere immobili</label>
                <select name="selectLOD3" id="selectLOD3" disabled></select>
                <br>
                <input type="radio" name="radioLOD" id="radioLOD4">
                <label for="radioLOD4">Opere mobili e superfici decorate</label>
                <select name="selectLOD4" id="selectLOD4" disabled></select>
                <br>
                <input type="checkbox" name="checkLOD" id="checkLOD5">
                <label for="selectLOD5">Attività</label>
                <select name="selectLOD5" id="selectLOD5" disabled></select>
              </form>
              <button id="applicaQuery">APPLICA</button>
              <button id="modificaDati" disabled>MODIFICA</button>
              <button id="salvaDati" disabled>SALVA</button>
              <!-- <br> -->
              <button id="creaDati">AGGIUNGI</button>
            </div>
          </div>
          <div id="risultatiDB"></div>
        </div>
        <div class="col-sm-5 fill" id="pannello-lat-db">
          <div class="panel panel-default fill">
            <div class="panel-heading" id="pannello-lat-gis-header" data-toggle="tooltip">
              <b>EXPLORER</b>
            </div>
            <div class="panel-body pannelloLatDB">
              <!-- <div id="calendar"></div> -->
            </div>
          </div>
        </div>
      </div>
      <!-- <div class="fill" id="tab4" data-tab-content>
        <div id="tabDashboard">QUI DASHBOARD</div>
      </div> -->
    </div>
  </div>

  <!-- SCRIPT PER GESTIONE CARICAMENTO -->
  <!-- <script>
    $(window).on('load', () => {
      $('#loading').hide();
    })
  </script> -->

  <!-- SCRIPT PER GESTIONE TABS -->
<script>
  const tabs = document.querySelectorAll('[data-tab-target]');
  const tabContents = document.querySelectorAll('[data-tab-content]');

  tabs.forEach((tab) => {
      tab.addEventListener("click", () => {
          // per prima cosa prendo il target su cui ho cliccato
          const target = document.querySelector(tab.dataset.tabTarget);
          // poi faccio sparire tutti i tab
          tabContents.forEach((tabContent) => {
              tabContent.classList.remove('active');
          });
          // questo è per rimuovere il background color di tutti
          tabs.forEach((tab) => {
              tab.classList.remove('active');
          });
          // qui aggiungo il background color al tab selezionato
          tab.classList.add('active');
          // infine rendo visibile solo quello su cui ho cliccato
          target.classList.add('active');
      });
  });
</script>
<!-- SCRIPT PER GESTIONE RADIO LOD DB -->
<script>
  setInterval(() => {
    if (document.getElementById('radioLOD3').checked) {
      // abilito select lod 3
      document.getElementById('selectLOD3').disabled = false;
      document.getElementById('selectLOD4').disabled = true;
      // document.getElementById('selectCappella').disabled = false;
      // document.getElementById('selectLOD5').disabled = false;
    }
    if (document.getElementById('radioLOD4').checked) {
      // abilito select lod 4
      document.getElementById('selectLOD4').disabled = false;
      document.getElementById('selectLOD3').disabled = true;
      // document.getElementById('selectCappella').disabled = false;
      // document.getElementById('selectLOD5').disabled = false;
    }
    if (document.getElementById('checkLOD5').checked) {
      document.getElementById('selectLOD5').disabled = false;
    }
    if (!(document.getElementById('checkLOD5').checked)) {
      document.getElementById('selectLOD5').disabled = true;
    }
  }, 100);
</script>
</body>
</html>
